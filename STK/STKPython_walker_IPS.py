# -*- coding: utf-8 -*-
"""
Created on Fri Oct 27 09:56:21 2023

@author: Benjamin
"""
import numpy as np
import matplotlib.pyplot as plt 
import os
import win32com.client
import comtypes
from comtypes.client import CreateObject

# Start a new instance of STK
uiApplication = win32com.client.Dispatch('STK11.Application')
#uiApplication = CreateObject("STK11.Application")
uiApplication.Visible = True
uiApplication.UserControl = True

# Start new instance of STK
#from comtypes.client import CreateObject
#uiApplication = CreateObject('STK11.Application')
#uiApplication.Visible = True

# Get our IAgStkObjectRoot interface
root = uiApplication.Personality2


from comtypes.gen import STKUtil
from comtypes.gen import STKObjects


# Create a new scenario from 1 Nov 2023 to 8 Nov 2023
scenario = root.NewScenario('SSR')
# scenario.StartTime = '1 Nov 2023 10:30:00.000'
# scenario.StopTime = '8 Nov 2023 10:30:00.000'
#scenario2 = scenario.QueryInterface(STKObjects.IAgSenario)
#scenario2.SetTimePeriod("1 Nov 2023 10:30:00.000", "8 Nov 2023 10:30:00.000")
root.Currentscenario.SetTimePeriod("1 Nov 2023 10:30:00.000", "8 Nov 2023 10:30:00.000")
root.ExecuteCommand('Animate * Reset');
root.Rewind()

altitude = 300
inclination = 98
Number_of_planes = 12 #make sure to also change in walker command !!
Sat_per_plane = 2     #make sure to also change in walker command !!

# Create a satellite
satellite = root.CurrentScenario.Children.New(18, 'MySatellite')  # 18 represents STK object type for Satellite

# IAgSatellite satellite: Satellite object
keplerian = satellite.Propagator.InitialState.Representation.ConvertTo(1) # eOrbitStateClassical, Use the Classical Element interface
keplerian.SizeShapeType = 0  # eSizeShapeAltitude, Changes from Ecc/Inc to Perigee/Apogee Altitude
keplerian.LocationType = 5 # eLocationTrueAnomaly, Makes sure True Anomaly is being used
keplerian.Orientation.AscNodeType = 0 # eAscNodeLAN, Use LAN instead of RAAN for data entry

# Assign the perigee and apogee altitude values:
keplerian.SizeShape.PerigeeAltitude = altitude      # km
keplerian.SizeShape.ApogeeAltitude = altitude       # km

# Assign the other desired orbital parameters:
keplerian.Orientation.Inclination = inclination        # deg
keplerian.Orientation.ArgOfPerigee = 0        # deg
keplerian.Orientation.AscNode.Value = 0       # deg
keplerian.Location.Value = 0                 # deg

# Apply the changes made to the satellite's state and propagate:
satellite.Propagator.InitialState.Representation.Assign(keplerian)
satellite.Propagator.Propagate()

# Create a sensor attached to the satellite
sensor = satellite.Children.New(20, 'sensor')  # 20 represents STK object type for Sensor

# IAgSensor sensor: Sensor object
# Change pattern and set
sensor.CommonTasks.SetPatternSimpleConic(48,1) #for rectangular with 45Â° swath: .SetPatternRectangular(45,45)

walker_constellation = root.ExecuteCommand('Walker  */Satellite/MySatellite  Type  Delta  NumPlanes  12  NumSatsPerPlane  2  InterPlanePhaseIncrement 1 ColorByPlane Yes ConstellationName walker_system SetUniqueNames Yes')

#EXPAND or COLLAPSE for all facility coordnates/parameters 
#%%
#toulouse
facility_tou = root.CurrentScenario.Children.New(8, 'Toulouse'); # ('eFacility', 'typeyourname')
facility_tou.Position.AssignGeodetic(43.428889,1.497778,0);  # absign LAT and LON
sensor_tou = facility_tou.Children.New(20, 'ToulouseGS'); # adding a sensor ('eSensor', 'typeyourname') and attaching it to the facility
sensor_tou.CommonTasks.SetPatternSimpleConic(30,0.17453293); # sensor proprieties (FOV, angular resolution)
sensor_tou.Graphics.FillVisible = True;
sensor_tou.Graphics.PercentTranslucency = 90;

#Papeete
facility_pap = root.CurrentScenario.Children.New(8, 'Papeete');
facility_pap.Position.AssignGeodetic(-17.511,-149.435,0);
sensor_pap = facility_pap.Children.New(20, 'GPapeeteGS');
sensor_pap.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_pap.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Ile Amsterdam 
facility_ile = root.CurrentScenario.Children.New(8, 'IleAmsterdam');
facility_ile.Position.AssignGeodetic(-37.493,77.337,0);
sensor_ile = facility_ile.Children.New(20, 'IleAmsterdamGS');
sensor_ile.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_ile.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Noumea
 
facility_nou = root.CurrentScenario.Children.New(8, 'Noumea');
facility_nou.Position.AssignGeodetic(-22.2758,166.458,0);
sensor_nou = facility_nou.Children.New(20, 'NoumeaGS');
sensor_nou.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_nou.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Kiev
 
facility_kie = root.CurrentScenario.Children.New(8, 'Kiev');
facility_kie.Position.AssignGeodetic(50.45, 30.523611,0);
sensor_kie = facility_kie.Children.New(20, 'KievGS');
sensor_kie.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_kie.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Kourou
 
facility_kou = root.CurrentScenario.Children.New(8, 'Kourou');
facility_kou.Position.AssignGeodetic(5.25144, -52.8047,0);
sensor_kou = facility_kou.Children.New(20, 'KourouGS');
sensor_kou.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_kou.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Redu
 
facility_red = root.CurrentScenario.Children.New(8, 'Redu');
facility_red.Position.AssignGeodetic(50.001889, 5.146656,0);
sensor_red = facility_red.Children.New(20, 'ReduGS');
sensor_red.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_red.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Santa Maria
 
facility_sm = root.CurrentScenario.Children.New(8, 'SantaMaria');
facility_sm.Position.AssignGeodetic(36.99725, -25.135722,0);
sensor_sm = facility_sm.Children.New(20, 'SantaMariaGS');
sensor_sm.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_sm.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Kiruna
 
facility_kir = root.CurrentScenario.Children.New(8, 'Kiruna');
facility_kir.Position.AssignGeodetic(67.857128, 20.964325,0);
sensor_kir = facility_kir.Children.New(20, 'KirunaGS');
sensor_kir.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_kir.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;

# Rapa
 
facility_rap = root.CurrentScenario.Children.New(8, 'Rapa');
facility_rap.Position.AssignGeodetic(-27.583333, -144.333333,0);
sensor_rap = facility_rap.Children.New(20, 'RapaGS');
sensor_rap.CommonTasks.SetPatternSimpleConic(30,0.17453293);
sensor_rap.Graphics.FillVisible = False;
#sensor.Graphics.PercentTranslucency = 90;
#%%

#Change DateFormat dimension to epoch seconds to make the data easier to handle in
#Python
# root.UnitPreferences.Item('DateFormat').SetCurrentUnit('EpSec')
# #Get the current scenario
# scenario = root.CurrentScenario
# #Set up the access object
# access = satellite.GetAccessToObject(facility_tou)
# access.ComputeAccess()
# #Get the Access AER Data Provider
# accessDP = access.DataProviders.Item('Access Data').Exec(scenario.StartTime, scenario.StopTime)

# accessStartTimes = accessDP.DataSets.GetDataSetByName('Start Time').GetValues
# accessStopTimes = accessDP.DataSets.GetDataSetByName('Stop Time').GetValues

constellation = root.CurrentScenario.Children.New(6,'MyConstellation') # eConstellation


m = 1
j = 1
for i in range (1,Number_of_planes):
    if j < 18:
        #satellite_name_1 = f'Satellite/MySatellite0{i}{i}'
        #satellite_name_2 = f'Satellite/MySatellite0{i}{i+1}'
        sensor_name_1 = f'Satellite/MySatellite0{m}{1}/Sensor/sensor{j}'
        sensor_name_2 = f'Satellite/MySatellite0{m}{2}/Sensor/sensor{j+1}'
        
        sensor_1 = root.GetObjectFromPath(sensor_name_1)
        sensor_2 = root.GetObjectFromPath(sensor_name_2)
        
        constellation.Objects.AddObject(sensor_1)
        constellation.Objects.AddObject(sensor_2)
        m += 1 
        j += 2
        
    if j > 17:
        
        sensor_name_1 = f'Satellite/MySatellite{m}{1}/Sensor/sensor{j}'
        sensor_name_2 = f'Satellite/MySatellite{m}{2}/Sensor/sensor{j+1}'
        
        sensor_1 = root.GetObjectFromPath(sensor_name_1)
        sensor_2 = root.GetObjectFromPath(sensor_name_2)
        
        constellation.Objects.AddObject(sensor_1)
        constellation.Objects.AddObject(sensor_2)
        m += 1 
        j += 2
    # if j < 9*Sat_per_plane:
    #     k=1
    #     for k in range (1,Sat_per_plane+1):
    #             sensor_name = f'Satellite/MySatellite0{m}{k}/Sensor/sensor{j+k-1}'    
    #             sensor = root.GetObjectFromPath(sensor_name)    
    #             constellation.Objects.AddObject(sensor)
        
    #     m += 1 
    #     j += Sat_per_plane
       
    # if j > 9*Sat_per_plane-1:
       
    #     k=1
    #     for k in range (1,Sat_per_plane+1):
    #             sensor_name_ = f'Satellite/MySatellite{m}{k}/Sensor/sensor{j+k-1}'    
    #             sensor = root.GetObjectFromPath(sensor_name)    
    #             constellation.Objects.AddObject(sensor)
    #     m += 1 
    #     j += Sat_per_plane
   



areaTarget = root.CurrentScenario.Children.New(2, 'ConflictRostov') # eAreaTarget
areaTarget.AreaTypeData.RemoveAll()


#%%
boundary = [ [46.8737462218482,	38.6812131301242],
[46.9104794792644,	38.8544164956015],
[46.9675700965622,	38.8992104694331],
[46.957379807944,	38.9171280589643],
[46.9777584417811,	38.9887984288923],
[47.0429179077255,	39.1022764959287],
[47.0286710671388,	39.1172078205397],
[47.0347773217177,	39.1858919137463],
[47.0225641139152,	39.230],
[47.0184924236241,	39.290411186017],
[47.0510572517418,	39.3053425106264],
[47.0693662348758,	39.233672152498],
[47.0998672354263,	39.2486034771091],
[47.1283190760672,	39.2635347619366],
[47.152472452579,	39.2343244398234],
[47.2011895100903,	39.228351909978],
[47.2417529169934,	39.2104343204467],
[47.2640495738994,	39.2283519464276],
[47.2883624812098,	39.1775854427523],
[47.2883624812098,	39.0760524354034],
[47.2579696015651,	39.0372309914174],
[47.2721551175695,	38.9775056929764],
[47.2518889310041,	38.944656778834],
[47.2052472588314,	38.9536155735997],
[47.1910438203964,	38.8819452154713],
[47.1768365798157,	38.8610413610182],
[47.1402862156325,	38.5594286038934],
[47.1484106916455,	38.4578955965429],
[47.144348608848,	38.3115686153642],
[47.1138730930793,	38.2219806677028],
[47.0561957004639,	38.1366321640889],
[47.1042007328927,	38.0637876722277],
[47.0962028863124,	38.0402893928067],
[47.0980156577605,	37.9757465743168],
[47.0868170514295,	37.9733967519987],
[47.1140095820229,	37.8888031485462],
[47.0868170514295,	37.8065593674103],
[47.0820169278529,	37.6890682515042],
[47.096416001027,	37.6021248257336],
[47.0852170541847,	37.5715771268358],
[47.0724153790045,	37.5269305027909],
[47.0227798347649,	37.4728845894738],
[46.8735960338954,	37.3036973825687],
[46.918555335399,	37.3154464941588],
[46.9506460447116,	37.2379023576603],
[46.9008972481393,	37.1086621301628],
[46.8714655950374,	37.0310512827143],
[46.8644728262229,	36.9875818427414],
[46.818997622722,	36.9095925533797],
[46.7489606048748,	36.8597305487059],
[46.699880475059,	36.831603264018],
[46.6305665019884,	36.7702346428794],
[46.6428564703857,	36.7510569487743],
[46.6779552856697,	36.8111470569718],
[46.7147845203423,	36.8239321863748],
[46.7445802658352,	36.7983619275674],
[46.7769863459962,	36.7293222287885],
[46.7778619154895,	36.6219271417978],
[46.7104014047874,	36.3675030666666],
[46.6718146377695,	36.3189195749324],
[46.5374233038083,	36.2140815138223],
[46.498257675826,	36.1689615122787],
[46.5028054195049,	36.1425345032718],
[46.5411934201479,	36.1542798406075],
[46.5265485675649,	36.1652910943609],
[46.5411934201479,	36.2034634407037],
[46.6103756348936,	36.2611608887882],
[46.6601500100013,	36.2224996863654],
[46.6734154397423,	36.1572588853859],
[46.6560038888752,	36.0992670817511],
[46.6676122073369,	36.0509405689256],
[46.6608513585807,	35.9499515793523],
[46.6484122148245,	35.8750454981839],
[46.6081329013595,	35.7956708239545],
[46.5857185678906,	35.7231810694104],
[46.5433550852294,	35.6724382412296],
[46.481827674501,	35.5854505357774],
[46.4485406115614,	35.4839648794159],
[46.4402156654663,	35.4513444898709],
[46.3978034221898,	35.4058304827602],
[46.3366282590736,	35.3443687894478],
[46.1752611094333,	35.2153960337042],
[46.1210117865794,	35.1416973171556],
[46.0762957213847,	34.9989060514608],
[46.0440675693622,	34.8399631526116],
[45.7056111779417,	35.010955637637],
[45.6128697935022,	35.0934396404184],
[45.4143402466818,	35.3050290388549],
[45.2858035855389,	35.5273772202632],
[45.3135518692513,	35.588343657101],
[45.3438072366128,	35.7174490527581],
[45.3790847397853,	35.7461391406813],
[45.4395092847071,	35.832209404453],
[45.4671822603851,	35.8501407404239],
[45.43447637043, 35.8752445673569],
[45.3740464387323,	35.9577285701373],
[45.3866413385175,	36.0437988339091],
[45.4495737532222,	36.0724889218323],
[45.4872995353264,	36.3020096252222],
[45.4646670960256,	36.3844936280027],
[45.444541741181,	36.4311150208783],
[45.4571209186439,	36.4490464442009],
[45.43950926927,	36.5207716640095],
[45.419374936632,	36.5638067958949],
[45.43950926927,	36.5889106228288],
[45.4218921209931,	36.61042818877],
[45.4017515038316,	36.6068419277802],
[45.3841225720204,	36.6391182766947],
[45.3438072211494,	36.6211869717423],
[45.3362448943885,	36.5638067958949],
[45.3664881649683,	36.4813226418694],
[45.346327796105,	36.4813226418694],
[45.3261602446791,	36.4884951638499],
[45.3009407048301,	36.4741501198877],
[45.2858035939092,	36.4311149880024],
[45.2605660972855,	36.4311149880024],
[45.2226888089943,	36.4239424660219],
[45.2091398975242,	36.412803288101],
[45.1812878201091,	36.4077034586775],
[45.145329512963,	36.423002946948],
[45.1120478721503,	36.4408523499316],
[45.0958497819808,	36.4497770514234],
[45.0796470957979,	36.4217279895928],
[45.0580363648536,	36.3720046527116],
[45.0508309721574,	36.2610833627443],
[45.0265060692599,	36.2190097699983],
[45.0508309721574,	36.0303160813205],
[45.0373184138907,	35.9907924032863],
[45.0102837222824,	35.9512687252521],
[45.0192967046819,	35.8989954736578],
[44.9994662709429,	35.8314227337943],
[45.0210991309381,	35.8110234160989],
[45.0373184138907,	35.8135733308107],
[45.0841483029799,	35.7434506762342],
[45.1291408701221,	35.603205367081],
[45.113847365052,	35.4795344516739],
[45.0455093642029,	35.3743032630791],
[45.0074049087369,	35.4233148461771],
[44.97620966976,	35.3497974715301],
[44.9484663138951,	35.2419719887151],
[44.9207095419987,	35.2370708304055],
[44.8825220748338,	35.158652297449],
[44.7956380461667,	35.0851349228034],
[44.7886816640858,	35.050826814634],
[44.8373587304801,	35.0312221813959],
[44.8304073793123,	34.9233966985808],
[44.809548294881,	34.7763619492868],
[44.7538871765046,	34.5313040337982],
[44.6981723959084,	34.4577866591525],
[44.5691264411497,	34.3401588597171],
[44.4782738348936,	34.1539148439469],
[44.4257944200029,	34.1245078940883],
[44.3907819453399,	33.9627696698657],
[44.4047894501767,	33.8451418704303],
[44.3767710872484,	33.7079094377568],
[44.4747766743541,	33.6343920631111],
[44.5237178489542,	33.4628515222682],
[44.5796003166212,	33.3746306726926],
[44.6563510952223,	33.5265665802961],
[44.7747663871381,	33.5265665806982],
[44.8512589199962,	33.5559735305567],
[44.8755761883229,	33.5951827971138],
[45.0385831824354,	33.5951827971138],
[45.1181838139995,	33.5020607892274],
[45.2011271147139,	33.3991364647232],
[45.1493017012992,	33.2373982405006],
[45.2321997236953,	33.1050669661366],
[45.3011891766174,	33.0266484331801],
[45.3563203699692,	33.0511542247291],
[45.3597642893131,	32.9188229310689],
[45.3632079980839,	32.7726986756432],
[45.3253156784363,	32.6648731928281],
[45.3390976383149,	32.5570477100131],
[45.3528762444146,	32.5129372852246],
[45.3804233953574,	32.5178384435354],
[45.4217189689443,	32.4884314936769],
[45.4801693645193,	32.606059293111],
[45.5591528975652,	32.7677975173336],
[45.6003176840149,	32.8266114170506],
[45.7373156812578,	33.1647913404244],
[45.8056889436254,	33.3951457809844],
[45.8330147794553,	33.5470816885866],
[45.8978598939511,	33.6156979049241],
[45.8637403151857,	33.6794129629506],
[45.9489999768078,	33.6941164378806],
[45.9966881900615,	33.6107967466145],
[46.0681435198344,	33.6205990632336],
[46.1573991038441,	33.5887033626543],
[46.109809634398,	33.5188248096575],
[46.0763889598009,	33.560992901984],
[46.0705382594953,	33.5007527700898],
[46.0270564942777,	33.5164151970637],
[46.03709378343,	33.4117895093277],
[46.0747173905056,	33.3587781932615],
[46.1098096304726,	33.1973346397875],
[46.1266049097744,	33.1216172137875],
[46.1540833919972,	33.0601480266025],
[46.1554569561261,	33.0363535025311],
[46.1142351186243,	33.0204904864831],
[46.1114858990079,	32.8995349891202],
[46.1169842010987,	32.7508192136731],
[46.1018625503496,	32.631846593316],
[46.0674797334241,	32.5366684970292],
[46.119733146432,	32.2590657161957],
[46.165070945094,	32.2372540691302],
[46.1925302288314,	32.1658704941775],
[46.228206797075,	32.0885382909456],
[46.2487788948964,	32.0568122458342],
[46.2665534980508,	31.9619136624639],
[46.2967021708406,	31.9163075056328],
[46.2614599258856,	31.8548383184471],
[46.283389919435,	31.7695746071908],
[46.3327003221004,	31.811215024316],
[46.3395454759396,	31.8925129815607],
[46.3532332130826,	31.9837253238346],
[46.3888052900074,	32.0194171099412],
[46.4475851920764,	31.9420849067094],
[46.4789995952576,	31.8052663932985],
[46.4976004603191,	31.8152692313813],
[46.4990307863207,	31.8339696740003],
[46.4976004603191,	31.8464366357457],
[46.520481161455,	31.8557868570552],
[46.5206637029161,	31.9023126612412],
[46.4922103303736,	32.0110221784525],
[46.5027503530411,	32.1013582561343],
[46.477450865864,	32.2667192119178],
[46.56489490241,	32.294279371211],
[46.5848924248121,	32.2605947210115],
[46.5575255462391,	32.1396362441151],
[46.6111937090239,	32.0967648852156],
[46.6469429686265,	31.980399768202],
[46.6795173042439,	32.0263333670228],
[46.6837190146875,	32.0783914456862],
[46.7393608305863,	32.0569557662559],
[46.7592939287186,	32.1763831231924],
[46.7739767577748,	32.2207856020534],
[46.8106663214775,	32.207005522406],
[46.8190489956228,	32.24834576134],
[46.8420946120197,	32.2345656817],
[46.7959934974488,	32.3708353582026],
[46.8284779421449,	32.3754287180854],
[46.8368578396215,	32.4565780760035],
[46.8366664088149,	32.5216222576808],
[46.8743695471318,	32.5859457388053],
[46.8680875290382,	32.6962145635909],
[46.8303799787459,	32.6962145635909],
[46.8680875290382,	32.9443194193599],
[46.8869313774518,	32.8064833883778],
[46.9496964144886,	32.9994538317527],
[47.1300474472513,	33.1097226565396],
[47.0499675644626,	32.990264763021],
[47.0937770236759,	32.8983740756988],
[47.1812879156032,	32.9535084880929],
[47.2374079307797,	33.1679603087927],
[47.2914855318513,	33.0985545155198],
[47.3385403704389,	33.1294015347517],
[47.3855533113299,	33.1114074402006],
[47.3872937249362,	33.0368604709886],
[47.4742412378461,	33.0677074902205],
[47.4168719963473,	33.1371132834919],
[47.5384899296878,	33.1396838684277],
[47.5558409422691,	33.0882721697089],
[47.5835906159393,	33.1011300943882],
[47.5709235120621,	33.2280158158783],
[47.4876205492299,	33.3358527997082],
[47.5400859897417,	33.4820724387998],
[47.5900336623075,	33.481158566055],
[47.5943478921408,	33.5816845679308],
[47.5055264183299,	33.6374308053353],
[47.483965298454,	33.6472703456095],
[47.515724227225,	33.9314612630496],
[47.4579664304477,	33.9571025488349],
[47.4858262867224,	34.182769442193],
[47.5264353500333,	34.3541001607504],
[47.5345533927698,	34.4683206397898],
[47.5649848619756,	34.6035817333879],
[47.5426701789372,	34.7598834415447],
[47.5223758574422,	34.8801155247438],
[47.5365827071137,	34.9582663788222],
[47.8562282291418,	34.8801155247438],
[47.9166991165569,	34.8199994831443],
[47.9408677048988,	34.9282083580224],
[48.0313993397641,	34.8560690941945],
[48.1418335084782,	34.8560690894746],
[48.0916655547597,	34.9883243809929],
[48.1438392077519,	35.2107537349105],
[48.0836341360644,	35.5413919637062],
[48.1378218748207,	35.6886762656236],
[48.0735931092266,	35.8299489776044],
[48.0916655702535,	35.9799609030822],
[47.8562282521486,	36.1062045904408],
[47.8421082193953,	36.5991561315546],
[47.9061312478634,	36.5398954922003],
[47.9257160018716,	36.6330385925846],
[47.9587484655314,	36.6220805807751],
[47.9697545963013,	36.5928592159479],
[48.0845673813793,	36.6111225689646],
[48.0821272189575,	36.7115710105563],
[48.035742135248,	36.8448934936631],
[48.0784667557695,	36.8905518762044],
[48.1857320492438,	36.8722885231876],
[48.1966897347357,	36.9252522469363],
[48.3073525110166,	36.905162558618],
[48.3207131072798,	36.8101931229311],
[48.4153515369661,	36.8284564759479],
[48.4779915099445,	36.8251055150202],
[48.4851194010658,	36.8537807673008],
[48.5183696498259,	36.8501963607223],
[48.5231179048871,	36.916507881504],
[48.6061403274198,	36.7587939942385],
[48.689026490131,	36.7086123028364],
[48.7020390733208,	36.7319109452731],
[48.7705952600761,	36.6924824734567],
[48.8095596415402,	36.7283265387445],
[48.7953942764315,	36.7820926366752],
[48.7717764434805,	36.8304821248141],
[48.797755448452,	36.8645339868366],
[48.7906715989779,	36.9738583859643],
[48.817820923637,	37.0240400773664],
[48.817820923637,	37.0760139720338],
[48.8496731176816,	37.108273630793],
[48.8166408238258,	37.1853383711605],
[48.8779691792996,	37.1978837940116],
[48.9274487943578,	37.3251302257822],
[48.9651146720301,	37.317961412725],
[49.0662008691698,	37.4254936085874],
[49.0638523586096,	37.4900129261058],
[49.1014152092305,	37.5025583489558],
[49.1201859808358,	37.5742464795314],
[49.1905131314758,	37.497181739163],
[49.2326615011225,	37.5760386827957],
[49.2093001766366,	37.8287393430736],
[49.2291505094584,	37.8771288312115],
[49.282041355547,	37.9535172166873],
[49.3235745305249,	37.871623374885],
[49.4440200381158,	37.8807226906402],
[49.5218559907982,	37.8412923223658],
[49.6594892975299,	38.0354110584879],
[49.7302890482302,	37.9579080742656],
[49.7607850504265,	37.9726562103149],
[49.7798353173821,	38.040497636137],
[49.8293309743598,	38.0139509912499],
[49.8445502272319,	38.0876916714916],
[49.8977798950666,	38.0316487545071],
[49.9357651728639,	38.1024398075392],
[49.985101304426,	38.2233745231364],
[50.0779435450645,	38.1761804877823],
[50.0836219335084,	38.3089137122178],
[50.0040632788,	38.3531581203624],
[49.9794112539862,	38.4062514101372],
[49.9983754716035,	38.4622943271199],
[49.9604395583251,	38.5124379896852],
[49.9756175131249,	38.5920779243458],
[49.960439553562,	38.6274734983321],
[49.9983754668441,	38.6923652969451],
[49.9357651680984,	38.6894156697355],
[49.9053793397995,	38.7454585867199],
[49.8559615187492,	38.9106377104618],
[49.7931660446507,	38.9460332369778],
[49.8179133863277,	39.0581190709449],
[49.8825773999961,	39.1820034137517],
[49.8388435639639,	39.2291974491059],
[49.7645956980364,	39.2645929756218],
[49.7417272908398,	39.3766788095905],
[49.7550685054647,	39.4474698626226],
[49.7330710630504,	39.5982541661276],
[49.6183105593281,	39.6493528014877],
[49.587142381273,	39.7455384680466],
[49.5540043592019,	39.8176777179653],
[49.5657027005262,	39.9198749886839],
[49.600780910778,	39.961956217802],
[49.6183105593281,	40.13929854052],
[49.6243873136103,	40.296967258645],
[49.5765237277792,	40.5327210706538],
[49.6960946171192,	40.9360589177065],
[49.802540864657,	41.038313583156],
[50.0001289622882,	41.1803339518371],
[50.0512234508969,	41.3280351352653],
[50.1022635971557,	41.3791624679892],
[50.1623483140732,	41.3166735057698],
[50.2023629058179,	41.3905241554251],
[50.0834192057802,	41.5055833836152],
[50.0318648206248,	41.6037286999581],
[49.9802550300719,	41.6037286999581],
[49.9171011295807,	41.755407825215],
[49.9171011295807,	41.8446308400725],
[49.8481115035938,	41.9249315534436],
[49.7732614638129,	42.0319991712729],
[49.6752059380375,	42.1747559950433],
[49.4088856532292,	42.0676883772152],
[49.1294374702744,	42.0766106787004],
[49.1411127538006,	42.371046627729],
[48.9949740124269,	42.3442797232719],
[49.0008278155598,	42.5316480544723],
[48.9422588235645,	42.6833271797292],
[48.8718851971666,	42.6565602752722],
[48.7484928107978,	42.7457832901285],
[48.6955173860178,	42.6744048782427],
[48.5834971055576,	42.7011717826997],
[48.5303480259625,	42.5673372604146],
[48.5067082881913,	42.371046627729],
[48.5244391257204,	42.2461344069291],
[48.4001929295655,	42.0944552816722],
[48.2756425238023,	42.139066789101],
[48.2578247661602,	42.0676883772152],
[48.1448346939198,	42.139066789101],
[48.0315953426213,	41.9963099653294],
[48.0315953426213,	42.4691919440717],
[47.9838410133209,	42.5673372604146],
[47.8822162290293,	42.6744048782427],
[47.4894419390534,	42.9527573900399],
[47.5485721797399,	43.0578240412764],
[47.5544815387548,	43.1278684754345],
[47.4598518272868,	43.1891573553233],
[47.4539318054277,	43.3029795608291],
[47.4776078938049,	43.5831572974615],
[47.4420897621094,	43.6269350688092],
[47.4598518272868,	43.688223948698],
[47.2879005398479,	43.8283128170141],
[47.2581970915581,	43.9333794683006],
[47.4065476345023,	43.9421350225199],
[47.4361677406262,	44.1084905536453],
[47.5603902314451,	44.1522683249942],
[47.5603902314451,	44.2660905305012],
[47.4716898714633,	44.3186238561195],
[47.1273038301637,	44.3536460731979],
[46.8585617879808,	44.2310683134215],
[46.810643923581,	44.0734683365668],
[46.6365834403825,	43.8808461426324],
[46.5403096426204,	43.9333794683006],
[46.3653774836111,	43.9684016853291],
[46.2988769062788,	43.8808461426324],
[46.4076539342428,	43.7232461657764],
[46.1595689316538,	43.644446177349],
[46.1667115713042,	43.3602344071623],
[46.4435071679312,	42.9342870310752],
[46.3638538135377,	42.7321425136102],
[46.5602872040066,	42.1942937082116],
[46.5453930809201,	42.067953384796],
[46.378797676276,	42.0860020024261],
[46.371326256012, 42.1690256435287],
[46.3040374726817,	42.1726353670547],
[46.2890731644947,	41.9704908495896],
[46.1542103572677,	41.8766380379091],
[46.1942042441517,	41.67810324397],
[45.9889281093774,	41.7178102027578],
[45.9487851408343,	41.169132226781],
[46.0568485812394,   41.125350876983],
[46.1288930397302,	41.0511461611057],
[46.1357495084279,	40.9769414452271],
[46.3000487011576,	40.9917823884034],
[46.2829571385266,	40.9324186156997],
[46.2248059283282,	40.9126306914664],
[46.2316504476013,	40.7592742786509],
[46.2829571750715,	40.7196982860399],
[46.2829571949117,	40.3239397247059],
[46.3547059168084,	40.2398410467107],
[46.3854265695126,	40.2893108572965],
[46.4502245403015,	40.2695229330619],
[46.4740780670265,	40.2497350088287],
[46.5421734161352,	40.2101591603596],
[46.5421734161352,	40.066696709662],
[46.7357772122753,	40.1112195391894],
[46.7764476437501,	40.0469087854274],
[46.7899976331991,	39.5522106795726],
[46.8204726405042,	39.4532710584025],
[46.7899976331991,	39.275179740294],
[46.7222135804108,	39.275179740294],
[46.6781082201682,	39.2158159675917],
[46.6135817268578,	39.1762401191239],
[46.6305698454721,	38.9189971040785],
[46.5693876706666,	38.8794212556107],
[46.7154304854156,	38.8596333313762],
[46.7357772122753,	38.8992091798453],
[46.8204726405042,	38.8893152177274],
[46.8441634884653,	38.9338380472548],
[46.8373957403942,	38.7013299375023]
    
    ]



#%%

areaTarget.CommonTasks.SetAreaTypePattern(boundary);




areaTarget = root.CurrentScenario.Children.New(2, 'ConflictZone') # eAreaTarget
areaTarget.AreaTypeData.RemoveAll()

#EXPAND or COLLAPSE for ConflictZone coordinates
#%%
boundary = [ [46.362200, 31.025391],
            [46.384925, 31.234131],
            [46.157251, 31.322021],
            [46.035438, 31.629639],
            [45.821618, 32.761230],
            [45.821618, 32.211914],
            [45.282737, 32.211914],
            [45.112535, 32.640381],
            [45.128029, 32.805176],
            [44.926280, 33.288574],
            [44.762810, 33.244629],
            [44.544128, 33.101807],
            [44.253891, 33.453369],
            [44.167327, 33.859863],
            [44.214559, 34.112549],
            [44.308911, 34.376221],
            [44.606693, 34.771729],
            [44.575419, 35.046387],
            [44.723820, 35.397949],
            [44.840711, 35.628662],
            [44.926280, 36.584473],
            [45.174486, 36.518555],
            [45.421614, 36.672363],
            [45.621613, 36.661377],
            [45.606254, 36.013184],
            [45.490925, 35.573730],
            [45.790287, 35.244141],
            [45.912640, 35.167236],
            [46.414500, 35.837402],
            [46.300843, 36.166992],
            [46.527921, 36.540527],
            [46.452334, 36.848145],
            [46.701374, 37.155762],
            [46.693844, 37.408447],
            [46.821709, 37.628174],
            [46.866766, 38.155518],
            [46.979241, 38.331299],
            [47.218401, 38.221436],
            [47.292918, 38.331299],
            [47.292918, 38.199463],
            [47.411927, 38.298340],
            [47.545491, 38.298340],
            [47.649140, 38.452148],
            [47.641744, 38.594971],
            [47.686108, 38.649902],
            [47.678716, 38.759766],
            [47.796854, 38.781738],
            [47.863188, 38.869629],
            [47.863188, 39.067383],
            [47.818975, 39.122314],
            [47.855822, 39.385986],
            [47.811602, 39.737549],
            [47.958855, 39.803467],
            [48.017639, 39.781494],
            [48.039666, 39.869385],
            [48.069020, 39.847412],
            [48.186271, 39.913330],
            [48.215541, 40.012207],
            [48.310556, 39.968262],
            [48.266725, 39.924316],
            [48.317857, 39.836426],
            [48.347053, 39.935303],
            [48.463667, 39.847412],
            [48.565486, 39.858398],
            [48.580015, 39.660645],
            [48.652596, 39.704590],
            [48.761273, 39.737549],
            [48.826366, 39.770508],
            [48.797446, 39.957275],
            [48.869715, 40.078125],
            [48.913026, 40.045166],
            [48.862492, 39.990234],
            [48.869715, 39.825439],
            [48.977922, 39.704590],
            [49.028338, 39.660645],
            [49.028338, 39.748535],
            [49.042734, 39.924316],
            [49.172105, 40.034180],
            [49.229495, 40.111084],
            [49.243832, 40.198975],
            [49.329767, 40.177002],
            [49.436975, 40.034180],
            [49.508317, 40.023193],
            [49.565316, 40.177002],
            [49.608022, 40.122070],
            [49.586673, 39.946289],
            [49.543949, 39.869385],
            [49.615136, 39.616699],
            [49.714622, 39.594727],
            [49.743009, 39.385986],
            [49.757197, 39.243164],
            [49.877623, 39.177246],
            [49.813905, 39.001465],
            [49.792647, 38.924561],
            [49.849314, 38.924561],
            [49.877623, 38.748779],
            [49.920054, 38.693848],
            [49.997749, 38.693848],
            [49.955386, 38.660889],
            [49.955386, 38.496094],
            [50.004806, 38.430176],
            [49.983632, 38.408203],
            [49.997749, 38.342285],
            [50.068272, 38.320313],
            [50.061224, 38.177490],
            [49.976572, 38.199463],
            [49.936201, 38.117065],
            [49.898843, 38.023682],
            [49.886646, 38.034668],
            [49.83704, 38.0896],
            [49.83704, 38.023682],
            [49.815765, 38.001709],
            [49.769637, 38.056641],
            [49.74478, 38.001709],
            [49.766086, 37.96875],
            [49.712803, 37.963257],
            [49.691473, 38.012695],
            [49.630988, 38.040161],
            [49.602498, 37.946777],
            [49.563298, 37.941284],
            [49.563298, 37.919312],
            [49.538336, 37.875366],
            [49.527634, 37.935791],
            [49.502653, 37.842407],
            [49.441934, 37.842407],
            [49.42406, 37.891846],
            [49.305935, 37.886353],
            [49.284427, 37.957764],
            [49.249141, 37.908325],
            [49.227608, 37.8479],
            [49.231908, 37.87262],
            [49.228214, 37.857513],
            [49.201286, 37.845154],
            [49.229112, 37.615814],
            [49.225522, 37.592468],
            [49.229112, 37.570496],
            [49.208468, 37.549896],
            [49.195, 37.508698],
            [49.182427, 37.499084],
            [49.177935, 37.515564],
            [49.160865, 37.559509],
            [49.135698, 37.569122],
            [49.141092, 37.555389],
            [49.141092, 37.537537],
            [49.123109, 37.580109],
            [49.098849, 37.490845],
            [49.065548, 37.507324],
            [49.056544, 37.481232],
            [49.04934, 37.452393],
            [49.057445, 37.420807],
            [49.05024, 37.411194],
            [49.047538, 37.386475],
            [49.021464, 37.396088],
            [49.024168, 37.368622],
            [48.994423, 37.372742],
            [48.985406, 37.365875],
            [48.995325, 37.357635],
            [48.998931, 37.342529],
            [48.991718, 37.337036],
            [48.989915, 37.310944],
            [48.976387, 37.324677],
            [48.97278, 37.299957],
            [48.965563, 37.299957],
            [48.958345, 37.31369],
            [48.945712, 37.31781],
            [48.943907, 37.308197],
            [48.93127, 37.338409],
            [48.919533, 37.33017],
            [48.914114, 37.30545],
            [48.921338, 37.298584],
            [48.919533, 37.275238],
            [48.908696, 37.268372],
            [48.905986, 37.246399],
            [48.907793, 37.224426],
            [48.885294, 37.214813],
            [48.878065, 37.191467],
            [48.853659, 37.19696],
            [48.816574, 37.19696],
            [48.816574, 37.164001],
            [48.827431, 37.147522],
            [48.827431, 37.139282],
            [48.846425, 37.147522],
            [48.838286, 37.132416],
            [48.842808, 37.103577],
            [48.817479, 37.084351],
            [48.814765, 37.073364],
            [48.809335, 37.070618],
            [48.81386, 37.030792],
            [48.803, 37.025299],
            [48.80119, 37.012939],
            [48.786706, 36.99646],
            [48.774029, 37.022552],
            [48.763161, 37.029419],
            [48.761349, 37.043152],
            [48.743229, 37.036285],
            [48.754285, 37.020493],
            [48.762891, 37.009506],
            [48.762891, 36.999893],
            [48.787794, 36.975174],
            [48.794584, 36.944962],
            [48.789605, 36.931229],
            [48.791868, 36.920929],
            [48.797752, 36.919556],
            [48.799562, 36.855698],
            [48.779192, 36.841278],
            [48.779192, 36.835098],
            [48.771042, 36.839218],
            [48.770136, 36.817245],
            [48.777381, 36.819992],
            [48.779192, 36.78772],
            [48.784625, 36.78978],
            [48.786436, 36.784286],
            [48.801825, 36.78978],
            [48.794584, 36.764374],
            [48.805445, 36.719742],
            [48.783267, 36.704636],
            [48.777834, 36.688843],
            [48.768325, 36.689529],
            [48.764168, 36.710815],
            [48.743331, 36.725922],
            [48.705258, 36.732788],
            [48.691654, 36.727295],
            [48.688025, 36.709442],
            [48.67986, 36.720428],
            [48.672601, 36.716309],
            [48.666249, 36.723175],
[48.659896, 36.734161],
[48.65445, 36.723175],
[48.646279, 36.724548],
[48.641739, 36.736908],
[48.624485, 36.735535],
[48.596512, 36.742401],
[48.597421, 36.776047],
[48.561966, 36.78978],
[48.57015, 36.822739],
[48.565149, 36.824112],
[48.568787, 36.856384],
[48.546049, 36.87149],
[48.550143, 36.882477],
[48.54241, 36.884537],
[48.538771, 36.899643],
[48.518295, 36.907883],
[48.51602, 36.849518],
[48.485386, 36.855011],
[48.480832, 36.830292],
[48.446207, 36.834412],
[48.443408, 36.84557],
[48.424034, 36.850719],
[48.416852, 36.850891],
[48.419702, 36.841621],
[48.414002, 36.823769],
[48.407132, 36.837845],
[48.405307, 36.818619],
[48.370631, 36.826172],
[48.368805, 36.811752],
[48.347931, 36.818619],
[48.343821, 36.804199],
[48.312759, 36.811752],
[48.315043, 36.872864],
[48.30499, 36.870804],
[48.305447, 36.910629],
[48.196629, 36.933289],
[48.181972, 36.867371],
[48.071906, 36.897583],
[48.055376, 36.88385],
[48.053539, 36.867371],
[48.029652, 36.864624],
[48.037381, 36.842651],
[48.034395, 36.833382],
[48.039448, 36.817589],
[48.039448, 36.813469],
[48.044272, 36.808319],
[48.052309, 36.805229],
[48.046798, 36.79287],
[48.050702, 36.787376],
[48.04565, 36.780853],
[48.056014, 36.763687],
[48.050044, 36.759567],
[48.048896, 36.749268],
[48.051651, 36.740341],
[48.060836, 36.747208],
[48.066576, 36.739998],
[48.069101, 36.728325],
[48.077594, 36.725235],
[48.08425, 36.716995],
[48.078742, 36.713905],
[48.080578, 36.705666],
[48.081266, 36.701202],
[48.08402, 36.697083],
[48.084938, 36.685753],
[48.090446, 36.678543],
[48.090675, 36.668243],
[48.086086, 36.664124],
[48.089528, 36.661377],
[48.09297, 36.65554],
[48.098247, 36.65863],
[48.099165, 36.653824],
[48.095035, 36.650734],
[48.093429, 36.635284],
[48.091134, 36.641121],
[48.093309, 36.647472],
[48.088031, 36.652107],
[48.088031, 36.648331],
[48.089064, 36.646442],
[48.087687, 36.644554],
[48.089064, 36.638718],
[48.086654, 36.636658],
[48.088949, 36.628933],
[48.086654, 36.627903],
[48.084818, 36.633224],
[48.082064, 36.630821],
[48.085048, 36.6255],
[48.08172, 36.623268],
[48.089064, 36.610394],
[48.090211, 36.60284],
[48.088949, 36.600609],
[48.085851, 36.605072],
[48.080717, 36.594772],
[48.080717, 36.586533],
[48.076127, 36.587219],
[48.077504, 36.581039],
[48.072913, 36.586533],
[48.061894, 36.587219],
[48.061469, 36.577606],
[48.057336, 36.582413],
[48.049069, 36.588593],
[48.039423, 36.573486],
[48.020125, 36.594086],
[48.012772, 36.563873],
[47.998981, 36.590652],
[47.999441, 36.578979],
[47.998062, 36.57692],
[47.956667, 36.585846],
[47.959888, 36.628418],
[47.918462, 36.640778],
[47.91616, 36.618805],
[47.920304, 36.591339],
[47.909252, 36.592026],
[47.905568, 36.543274],
[47.876082, 36.549454],
[47.878386, 36.575546],
[47.846119, 36.585159],
[47.836199, 36.519928],
[47.827343, 36.523361],
[47.820885, 36.454697],
[47.82596, 36.427231],
[47.826421, 36.412125],
[47.828727, 36.397018],
[47.828266, 36.377792],
[47.836568, 36.375732],
[47.840258, 36.322174],
[47.819962, 36.332474],
[47.814887, 36.302261],
[47.816733, 36.298141],
[47.817194, 36.283035],
[47.832417, 36.264496],
[47.831033, 36.203384],
[47.837952, 36.189651],
[47.859623, 36.199265],
[47.855935, 36.177292],
[47.848558, 36.181412],
[47.84118, 36.100388],
[47.850402, 36.098328],
[47.848558, 36.074295],
[47.86331, 36.067429],
[47.868842, 36.057129],
[47.879887, 36.053696],
[47.879887, 36.080475],
[47.859147, 36.088028],
[47.863757, 36.117554],
[47.869749, 36.11618],
[47.890485, 36.1306],
[47.894171, 36.119614],
[47.898777, 36.13266],
[47.921344, 36.105194],
[47.927789, 36.120987],
[47.938837, 36.107941],
[47.927329, 36.082535],
[47.959086, 36.074295],
[47.955405, 36.050949],
[47.961386, 36.043396],
[47.970127, 36.072235],
[48.000019, 36.063995],
[48.000019, 36.043396],
[48.016107, 36.03447],
[48.022082, 36.065369],
[48.056995, 36.052322],
[48.042936, 35.978851],
[48.05947, 35.982971],
[48.056715, 35.981598],
[48.055797, 35.971985],
[48.077835, 35.981598],
[48.082426, 35.982971],
[48.08518, 35.977478],
[48.088851, 35.960999],
[48.065899, 35.823669],
[48.095276, 35.809937],
[48.092523, 35.739899],
[48.13656, 35.704193],
[48.07049, 35.524292],
[48.092523, 35.520172],
[48.091605, 35.48996],
[48.099865, 35.443268],
[48.096194, 35.414429],
[48.108124, 35.418549],
[48.117298, 35.344391],
[48.142062, 35.288086],
[48.131057, 35.259247],
[48.137477, 35.223541],
[48.138394, 35.200195],
[48.129586, 35.109558],
[48.11124, 35.087585],
[48.120414, 35.062866],
[48.085543, 35.040894],
[48.080035, 34.999695],
[48.083707, 34.988708],
[48.081871, 34.917297],
[48.113075, 34.914551],
[48.122248, 34.895325],
[48.122248, 34.870605],
[48.056161, 34.876099],
[48.045138, 34.848633],
[48.002861, 34.8349],
[48.010216, 34.859619],
[47.975271, 34.865112],
[47.978951, 34.900818],
[47.92373, 34.93103],
[47.921888, 34.909058],
[47.927413, 34.881592],
[47.929254, 34.851379],
[47.901625, 34.856873],
[47.910836, 34.815674],
[47.853699, 34.807434],
[47.883197, 34.854126],
[47.857387, 34.870605],
[47.840788, 34.898071],
[47.828089, 34.902878],
[47.818632, 34.879189],
[47.758454, 34.892578],
[47.771386, 34.958496],
[47.736279, 34.972229],
[47.732582, 34.95575],
[47.723339, 34.95575],
[47.708547, 34.963989],
[47.709471, 34.933777],
[47.677099, 34.937897],
[47.668771, 34.899445],
[47.627113, 34.917297],
[47.638225, 34.933777],
[47.606734, 34.94751],
[47.585072, 34.936523],
[47.540564, 34.958496],
[47.51644, 34.909058],
[47.52572, 34.793701],
[47.533142, 34.755249],
[47.555404, 34.612427],
[47.54984, 34.546509],
[47.531287, 34.486084],
[47.510871, 34.30481],
[47.484876, 34.233398],
[47.473732, 34.156494],
[47.477849, 34.142761],
[47.450152, 33.947754],
[47.505877, 33.925781],
[47.476165, 33.662109],
[47.49845, 33.640137],
[47.49845, 33.596191],
[47.561543, 33.607178],
[47.580085, 33.568726],
[47.5875, 33.486328],
[47.542994, 33.486328],
[47.52815, 33.338013],
[47.461302, 33.348999],
[47.468734, 33.31604],
[47.509722, 33.272095],
[47.554256, 33.296814],
[47.520859, 33.222656],
[47.580216, 33.236389],
[47.565383, 33.1073],
[47.531994, 33.096313],
[47.53756, 33.145752],
[47.511578, 33.156738],
[47.504152, 33.123779],
[47.405662, 33.121033],
[47.411242, 33.071594],
[47.474439, 33.071594],
[47.470724, 33.057861],
[47.436985, 33.052368],
[47.42583, 33.027649],
[47.384909, 33.033142],
[47.384909, 33.110046],
[47.327193, 33.140259],
[47.302971, 33.096313],
[47.237703, 33.186951],
[47.226506, 33.134766],
[47.198503, 33.143005],
[47.213439, 33.1073],
[47.207839, 33.063354],
[47.181694, 33.041382],
[47.163011, 33.033142],
[47.179826, 32.997437],
[47.181694, 32.975464],
[47.142453, 32.920532],
[47.088215, 32.904053],
[47.035795, 33.033142],
[47.073243, 33.046875],
[47.048905, 33.071594],
[47.051413, 33.077087],
[47.110665, 33.077087],
[47.136844, 33.101807],
[47.095699, 33.162231],
[46.968322, 33.041382],
[46.996758, 32.947998],
[46.976135, 32.923279],
[46.940495, 32.947998],
[46.940495, 32.972717],
[46.91985, 32.975464],
[46.917973, 32.926025],
[46.899198, 32.928772],
[46.891686, 32.838135],
[46.867265, 32.849121],
[46.867265, 32.904053],
[46.852231, 32.923279],
[46.837193, 32.816162],
[46.829672, 32.783203],
[46.807104, 32.794189],
[46.818389, 32.772217],
[46.814628, 32.703552],
[46.852231, 32.695313],
[46.840953, 32.629395],
[46.857869, 32.582703],
[46.863507, 32.555237],
[46.871023, 32.54425],
[46.869144, 32.530518],
[46.839073, 32.536011],
[46.818469, 32.541504],
[46.810946, 32.475586],
[46.833513, 32.470093],
[46.824111, 32.376709],
[46.795897, 32.384949],
[46.790252, 32.35199],
[46.846672, 32.2229],
[46.818469, 32.269592],
[46.801541, 32.2229],
[46.763902, 32.2229],
[46.756371, 32.156982],
[46.745073, 32.170715],
[46.733772, 32.124023],
[46.741306, 32.102051],
[46.741306, 32.052612],
[46.724353, 32.063599],
[46.686661, 32.099304],
[46.665918, 32.011414],
[46.641395, 31.992188],
[46.650828, 31.929016]]
#%% 
 
areaTarget.CommonTasks.SetAreaTypePattern(boundary);

#customRegion = root.GetObjectFromPath('AreaTarget/ConflictZone');

covDef = root.CurrentScenario.Children.New(7,'CovDef');


advanced = covDef.Advanced;
advanced.AutoRecompute = False;

covDef.Grid.BoundsType = 0;
covGrid = covDef.Grid;
bounds = covGrid.Bounds;
bounds.AreaTargets.Add('AreaTarget/ConflictZone');
Res = covGrid.Resolution;
Res.LatLon = 0.5;
covDef.AssetList.Add('Constellation/MyConstellation');

fom = covDef.Children.New(25,'RevisitTime');
fom.SetDefinitionType(10);
fom.Definition.SetComputeType(1) # eMaximum
#fom.Definition.Satisfaction.EnableSatisfaction = True;
#access = satellite.GetAccessToObject(facility_tou);
covDef.ComputeAccesses();



#EXPORT csv tests

# fomDataProvider = fom.DataProviders.GetDataPrvFixedFromPath("Value by Grid Point")
# fomResults = fomDataProvider.Exec()

# avgTime = fomResults.DataSets.GetDataSetByName("FOM value (sec)").GetValues()[0]

# print("the fom is {a:4.2f} min.".format(a=avgTime))

# Generate a coverage report
# Assuming you have a coverage object named 'MyCoverage'
coverage_object = root.GetObjectFromPath('CoverageDefinition/CovDef')  # Make sure to replace 'MyCoverage' with your coverage name

#report_create = root.ExecuteCommand('ReportCreate */Analysis/FigureOfMerit/CoverageDefinition/CovDef/RevisitTime Type Export Style "Value By Grid Point" File "C:\result_test.csv"');


#report_create = root.ExecuteCommand('ReportCreate */Satellite/MySatellite Type Display Style "LLA Position" "C:/Utilisateurs/Benjamin/LLA.csv" ')
#report_create = root.ExecuteCommand('ReportCreate */Satellite/MySatellite Type Export Style "Lighting Times" File "C:\Tsoft\test.csv" TimePeriod "1 Nov 2023 10:30:00.000" "8 Nov 2023 10:30:00.000" TimeStep 60');

target = root.Currentscenario.Children.New(STKObjects.eTarget, "GroundTarget");
#target2 = target.QueryInterface(STKObjects.IAgTarget)
target.Position.AssignGeodetic(50,-100,0)

access = satellite.GetAccessToObject(target)
access.ComputeAccess()

accessDP = access.DataProviders.Item('Access Data')
accessDP2 = accessDP.QueryInterface(STKObjects.IAgDataPrvInterval)

results = accessDP.Exec("1 Nov 2023 10:30:00.000", "8 Nov 2023 10:30:00.000")
accessStartTimes = results.DataSets.GetDataSetByName('Start Time').GetValues()
accessStopTimes = results.DataSets.GetDataSetByName('Stop Time').GetValues()
print(accessStartTimes,accessStopTimes)

satelliteDP = satellite.DataProviders.Item('LLA State')
satelliteDP2 = satelliteDP.Group.Item('Fixed')
rptElements = ['Time','Lat','Lon','Alt']
satelliteDPTimeVar = satelliteDP2.ExecElements(accessStartTimes,accessStopTimes, 60, rptElements)
satelliteAltitude = satelliteDPTimeVar.DataSets.GetDataSetByName('Alt').GetValues()
print(satelliteAltitude)


# FoMDP = fom.DataProviders.Item('Value By Point')
# FoMDP2 = FoMDP.QueryInterface(STKObjects.IAgDataProviderGroup)

# rptElements = ['Latitude','Longitude','FOM Value']
# FoMDPTimeVar = FoMDP2.ExecElements("1 Nov 2023 10:30:00.000", "8 Nov 2023 10:30:00.000", 60, rptElements)
# FoMDPLat = FoMDPTimeVar.DataSets.GetDataSetByName('Latitude').GetValues()
# print(FoMDPLat)




































